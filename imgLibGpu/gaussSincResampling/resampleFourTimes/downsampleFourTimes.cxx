#if HOSTCODE
#include "downsampleFourTimes.h"
#endif

#include "gpuDevice/gpuDevice.h"

#include "gaussSincResampling/gaussSincResamplingSettings.h"
#include "gaussSincResampling/resampleFourTimes/allTypes.h"

//================================================================
//
// Instance
//
//================================================================

#if GAUSS_SINC_RESAMPLING_HQ == 0

    static devConstant float32 FILTER0[] = {-0.00029084f, -0.00003406f, +0.00034787f, +0.00072855f, +0.00093066f, +0.00078977f, +0.00023691f, -0.00063277f, -0.00154314f, -0.00209884f, -0.00192455f, -0.00084336f, +0.00097526f, +0.00297641f, +0.00434261f, +0.00427403f, +0.00234801f, -0.00117904f, -0.00527881f, -0.00836851f, -0.00883129f, -0.00569827f, +0.00075606f, +0.00877999f, +0.01546327f, +0.01761671f, +0.01299459f, +0.00145780f, -0.01438467f, -0.02940619f, -0.03714952f, -0.03171398f, -0.00979290f, +0.02781749f, +0.07581280f, +0.12533387f, +0.16609455f, +0.18909354f, +0.18909354f, +0.16609455f, +0.12533387f, +0.07581280f, +0.02781749f, -0.00979290f, -0.03171398f, -0.03714952f, -0.02940619f, -0.01438467f, +0.00145780f, +0.01299459f, +0.01761671f, +0.01546327f, +0.00877999f, +0.00075606f, -0.00569827f, -0.00883129f, -0.00836851f, -0.00527881f, -0.00117904f, +0.00234801f, +0.00427403f, +0.00434261f, +0.00297641f, +0.00097526f, -0.00084336f, -0.00192455f, -0.00209884f, -0.00154314f, -0.00063277f, +0.00023691f, +0.00078977f, +0.00093066f, +0.00072855f, +0.00034787f, -0.00003406f, -0.00029084f};
    #define FILTER_SRC_SHIFT (-36)

#elif GAUSS_SINC_RESAMPLING_HQ == 1

    static devConstant float32 FILTER0[] = {-0.00038822f, -0.00039774f, -0.00021945f, +0.00010815f, +0.00046501f, +0.00068767f, +0.00063759f, +0.00027391f, -0.00030398f, -0.00087150f, -0.00115775f, -0.00096439f, -0.00027632f, +0.00069087f, +0.00154323f, +0.00185687f, +0.00137195f, +0.00014940f, -0.00139183f, -0.00259897f, -0.00284452f, -0.00182486f, +0.00023469f, +0.00258259f, +0.00419003f, +0.00417597f, +0.00224300f, -0.00107697f, -0.00451560f, -0.00651785f, -0.00590460f, -0.00248123f, +0.00269688f, +0.00758290f, +0.00989440f, +0.00810894f, +0.00229020f, -0.00565629f, -0.01251015f, -0.01494436f, -0.01099595f, -0.00119672f, +0.01118721f, +0.02106329f, +0.02337686f, +0.01531121f, -0.00202710f, -0.02319957f, -0.03965794f, -0.04235580f, -0.02494379f, +0.01356477f, +0.06768032f, +0.12641431f, +0.17616928f, +0.20467191f, +0.20467191f, +0.17616928f, +0.12641431f, +0.06768032f, +0.01356477f, -0.02494379f, -0.04235580f, -0.03965794f, -0.02319957f, -0.00202710f, +0.01531121f, +0.02337686f, +0.02106329f, +0.01118721f, -0.00119672f, -0.01099595f, -0.01494436f, -0.01251015f, -0.00565629f, +0.00229020f, +0.00810894f, +0.00989440f, +0.00758290f, +0.00269688f, -0.00248123f, -0.00590460f, -0.00651785f, -0.00451560f, -0.00107697f, +0.00224300f, +0.00417597f, +0.00419003f, +0.00258259f, +0.00023469f, -0.00182486f, -0.00284452f, -0.00259897f, -0.00139183f, +0.00014940f, +0.00137195f, +0.00185687f, +0.00154323f, +0.00069087f, -0.00027632f, -0.00096439f, -0.00115775f, -0.00087150f, -0.00030398f, +0.00027391f, +0.00063759f, +0.00068767f, +0.00046501f, +0.00010815f, -0.00021945f, -0.00039774f, -0.00038822f};
    #define FILTER_SRC_SHIFT (-54)

#else

    #error

#endif

//----------------------------------------------------------------

#define FUNCSPACE gaussSincResampling
#define FUNCNAME downsampleFourTimesConservative

#define PACK_SIZE 1
#define PACK_TO_SRC_FACTOR 4

#define HORIZONTAL_FIRST 1

#define FOREACH_TYPE(action) \
    \
    action(int8, int8, int8, 1) \
    action(uint8, uint8, uint8, 1) \
    action(float16, float16, float16, 1) \
    \
    action(int8_x2, int8_x2, int8_x2, 2) \
    action(uint8_x2, uint8_x2, uint8_x2, 2) \
    action(float16_x2, float16_x2, float16_x2, 2)

# include "rationalResample/rationalResampleMultiple.inl"

////

#undef FUNCNAME
#define FUNCNAME downsampleFourTimesConservativeDual

#undef TASK_COUNT
#define TASK_COUNT 2

# include "rationalResample/rationalResampleMultiple.inl"
